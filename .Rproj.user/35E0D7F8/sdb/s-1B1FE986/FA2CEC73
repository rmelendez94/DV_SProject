{
    "contents" : "# server.R\nrequire(\"jsonlite\")\nrequire(\"RCurl\")\nrequire(ggplot2)\nrequire(dplyr)\nrequire(shiny)\n\nshinyServer(function(input, output) {\n  \n  output$scatterPlot <- renderPlot({\n    # Start your code here.\n    # Here is the scatter plot\n    dfs <- df %>% select(DURATION, Y, CONS_PRICE_IDX)\n    dfsY <- df %>% select(DURATION, Y, CONS_PRICE_IDX) %>% filter(Y=='yes')\n    dfsN <- df %>% select(DURATION, Y, CONS_PRICE_IDX) %>% filter(Y=='no')\n    \n    plot1 <- ggplot() + \n      coord_cartesian() + \n      scale_x_continuous() +\n      scale_y_continuous() +\n      labs(title='Portuguese Bank Marketing Campaign Effectiveness\\nScatter Plot') +\n      labs(x=\"Duration\", y=paste(\"Consumer Price Index\")) +\n      layer(data=dfs, \n            mapping=aes(x=as.numeric(as.character(DURATION)), y=as.numeric(as.character(CONS_PRICE_IDX)), color=Y),\n            stat=\"identity\",\n            stat_params=list(),\n            geom=\"point\",\n            geom_params=list(alpha=.8), \n            position=position_jitter(width=0, height=0)\n      )+\n      layer(data=dfsY, \n            mapping=aes(x=as.numeric(as.character(DURATION)), y=as.numeric(as.character(CONS_PRICE_IDX)), color=Y),\n            stat=\"smooth\",\n            stat_params=list(method= lm, se= FALSE),\n            geom=\"smooth\",\n            geom_params=list(alpha= .8), \n            position=position_jitter(width=0, height=0)\n      )+\n      layer(data=dfsN,\n            mapping=aes(x=as.numeric(as.character(DURATION)), y=as.numeric(as.character(CONS_PRICE_IDX)), color=Y),\n            stat=\"smooth\",\n            stat_params=list(method= lm, se= FALSE),\n            geom=\"smooth\",\n            geom_params=list(alpha= .8), \n            position=position_jitter(width=0, height=0)\n      )\n    # End your code here.\n    return(plot1)\n  })\n  \n  output$barPlot <- renderPlot({\n    # Start your code here.\n    # Here is the bar chart\n    \n    # End your code here.\n    return(plot2)\n  })\n\n  output$crosstabPlot <- renderPlot({\n# Start your code here.\n\n# Here is the Crosstab and KPI\n    \nKPI_Low_Max_value = input$KPI1     \nKPI_Medium_Max_value = input$KPI2\n    \ndf %>% group_by(JOB) %>% summarize() %>% View()\n\ndfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))\n\n#spread(dfc, Y, AVG_DURATION) %>% View\n\ndfc$EDUCATION <- factor(dfc$EDUCATION, levels = c(\"illiterate\", \"basic4y\", \"basic6y\", \"basic9y\", \"highschool\", \"universitydegree\", \"professionalcourse\", \"unknown\"))\n    \nplot3 <- ggplot() + \n  coord_cartesian() + \n  scale_x_discrete() +\n  scale_y_discrete() +\n  scale_fill_manual(values = c(\"green\",\"yellow\",\"red\")) + \n  facet_grid(.~EDUCATION) + \n  labs(title='Portuguese Bank Marketing Campaign Effectiveness\\nCrosstab\\nAVG_DURATION') +\n  labs(x=paste(\"EDUCATION/Y\"), y=paste(\"HOUSING\")) +\n  layer(data=dfc, \n        mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION), \n        stat=\"identity\", \n        stat_params=list(), \n        geom=\"text\",\n        geom_params=list(colour=\"black\", size=2.8), \n        position=position_identity()\n  ) +\n  layer(data=dfc, \n        mapping=aes(x=Y, y=HOUSING, fill=KPI), \n        stat=\"identity\", \n        stat_params=list(), \n        geom=\"tile\",\n        geom_params=list(alpha=0.50), \n        position=position_identity()\n  )\n\n# End your code here.\n      return(plot3)\n  })\n})\n",
    "created" : 1447883384562.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2328864247",
    "id" : "FA2CEC73",
    "lastKnownWriteTime" : 1447883754,
    "path" : "~/Desktop/Desktop/UT/Fall 2015/Data Visualization/DV_SProject/02 Shiny/server.R",
    "project_path" : "02 Shiny/server.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}